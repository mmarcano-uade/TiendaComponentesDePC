<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="styles.css">
    <title>Fullgarden</title>
</head>
<body>
<header>
     <nav class="navbar navbar-expand-lg bg-white fixed-top">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="index.html">
                <div class="ico-home"></div>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"
                    aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-end" id="mainNav">
                <ul class="navbar-nav align-items-lg-center gap-lg-3">
                    <li class="nav-item">
                        <a class="nav-link fw-semibold" href="index.html#nosotros">Nosotros</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-semibold" href="products.html">Productos</a>
                    </li>
                      <li class="nav-item">
                        <a class="nav-link fw-semibold" href="promociones.html">Promociones</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link fw-semibold" href="index.html#contacto">Contacto</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>
<main>
  <div class="container mt-6">
      <div class="card mb-4 border-0 shadow-sm bg-light">
          <div class="card-body d-flex flex-column flex-md-row align-items-center justify-content-between">
              <div>
                  <h5 class="card-title mb-1 fw-bold">ðŸ”¥ Ofertas en todas las compras</h5>
                  <p class="card-text mb-2 mb-md-0">
                      Hasta <span class="fw-bold text-danger">10% OFF</span> en compras superiores a 30.000$ Â· Â¡SÃ³lo por tiempo limitado!
                  </p>
              </div>
              <a href="products.html" class="btn btn-dark px-4 mt-2 mt-md-0">Comprar ahora</a>
          </div>
      </div>
      <div class="row justify-content-center pt-5 pb-5 frame-container">
          <div class="col text-center">
              <div class="row gap-2 justify-content-center" id="productContainerRender"></div>
          </div>
           <section id="results" class="mt-3">
                <h4>Resumen</h4>
                <div><strong>Total sin descuento:</strong> <span id="subtotal">$0</span></div>
                <div><strong>Descuentos:</strong> <span id="discountsTotal">$0</span></div>
                <ul id="discountsBreakdown"></ul>
                <div><strong>Total final:</strong> <span id="finalTotal">$0</span></div>
            </section>
        </div>
  </div>
</main>
<footer class="mt-5">
    <div class="container" id="contacto">
        <div class="row">
            <div class="col-md-5 mb-4">
                <h2 class="mb-3">UbicaciÃ³n & Contacto</h2>
                <p><i class="bi bi-geo-alt-fill "></i> Galerias jardin, Microcentro, CABA</p>
                <p><i class="bi bi-telephone-fill "></i> (11) 8888-7890</p>
                <p><i class="bi bi-envelope-fill "></i> info@fullgarden.com</p>
                <div class="mt-3">
                    <a href="#" class="text-dark me-3"><i class="bi bi-facebook fs-4"></i></a>
                    <a href="#" class="text-dark me-3"><i class="bi bi-twitter fs-4"></i></a>
                    <a href="#" class="text-dark"><i class="bi bi-instagram fs-4"></i></a>
                </div>
                <div class="mt-4">
                    <iframe src="https://maps.google.com/maps?q=Buenos%20Aires&t=&z=13&ie=UTF8&iwloc=&output=embed"
                            width="100%" height="200" style="border:0;" allowfullscreen="" loading="lazy">
                    </iframe>
                </div>
            </div>

            <div class="col-md-7">
                <h2 class="mb-3">EnvÃ­anos un mensaje</h2>
                <form>
                    <div class="mb-3">
                        <label for="nombre" class="form-label">Nombre</label>
                        <input type="text" class="form-control" id="nombre" placeholder="Tu nombre" required>
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">Correo</label>
                        <input type="email" class="form-control" id="email" placeholder="correo@ejemplo.com" required>
                    </div>
                    <div class="mb-3">
                        <label for="asunto" class="form-label">Asunto</label>
                        <select id="asunto" class="form-select" required>
                            <option selected disabled value="">Selecciona...</option>
                            <option value="consulta">Consulta</option>
                            <option value="soporte">Soporte</option>
                            <option value="presupuesto">Presupuesto</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="mensaje" class="form-label">Mensaje</label>
                        <textarea class="form-control" id="mensaje" rows="5" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary px-4">Enviar</button>
                </form>
            </div>
        </div>
    </div>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
<script>
    var THRESHOLD_DISCOUNT = 200_000
   const cart = {};
   var products = [
        {
            id: "gpu",
            promotion: "3x2OFF",
            price: 500000,
            priceFormat: "500.000",
            imageUrl: "td.png",
            name: "Placa de Video Asrock Radeon RX 9070 XT 16GB GDDR6 Steel",
        },
        {
            id: "mem",
            promotion:"2x50OFF",
            price: 40000,
            priceFormat: "40.000",
            imageUrl: "mem.png",
            name: "Memoria Team DDR4 4GB 2400MHz Elite Plus Red",
        },
         {
            id: "source",
            promotion:"2x50OFF",
            price: 100000,
            priceFormat: "100.000",
            imageUrl: "fuente.png",
            name: "Fuente Thermaltake Smart BX1 650W RGB 80 Plus Bronze",
        },
           {
            id: "mother",
            price: 200000,
            priceFormat: "200.000",
            imageUrl: "mother.png",
            name: "Fuente Thermaltake Smart BX1 650W RGB 80 Plus Bronze",
        }
    ]

</script>

<script>
    function fmtARS(n){
        return typeof n === "number"
            ? n.toLocaleString("es-AR", { style: "currency", currency: "ARS", maximumFractionDigits: 0 })
            : "$0";
    }

    function discountPerItem(product, qty) {
        if (!qty || qty <= 0) return 0;
        const price = product.price || 0;

        switch (product.promotion) {
            case "2x50OFF": {
                if (qty <= 0) return 0;
                const pairs = Math.floor(qty / 2); 
                return pairs * (price * 0.5);    
            }
            case "3x2OFF": {
                const trios = Math.floor(qty / 3);
                return trios * price;
            }
            default:
                return 0;
        }
    }

    function calculateCart(cartMap) {
        let subtotal = 0;
        let itemDiscount = 0;
        const itemBreakdown = [];

        products.forEach((p) => {
            const qty = cartMap[p.id] || 0;
            if (qty > 0) {
            const line = p.price * qty;
            const disc = discountPerItem(p, qty);
            subtotal += line;
            itemDiscount += disc;
            if (disc > 0) {
                itemBreakdown.push({
                    id: p.id,
                    name: p.name,
                    detail: promoLabel(p.promotion),
                    amount: disc,
                });
            }
            }
        });
        const afterItem = subtotal - itemDiscount;
        const thresholdApplies = subtotal >= THRESHOLD_DISCOUNT;
        const thresholdDiscount = thresholdApplies ? afterItem * 0.10 : 0;

        const totalDiscount = itemDiscount + thresholdDiscount;
        const finalTotal = subtotal - totalDiscount;

        return {
            subtotal,
            itemDiscount,
            itemBreakdown,
            thresholdDiscount,
            totalDiscount,
            finalTotal,
        };
    }

    function promoLabel(code){
        switch (code) {
            case "2x50OFF": return "LlevÃ¡ 2 y 50% en la 2da";
            case "3x2": return "Promo 3Ã—2";
            default: return "";
        }
    };

    function hookInteractions() {
        products.forEach((p) => {
            const input = document.getElementById(`qty-${p.id}`);
            if (input) {
            input.addEventListener("input", () => {
                const qty = Math.max(0, parseInt(input.value, 10) || 0);
                console.log(qty)
                cart[p.id] = qty;
                refreshTotals();
            });
            }
        });
    }

    function refreshTotals() {
        const r = calculateCart(cart);
        document.getElementById("subtotal").textContent = fmtARS(r.subtotal);
        document.getElementById("discountsTotal").textContent = fmtARS(r.totalDiscount);
        document.getElementById("finalTotal").textContent = fmtARS(r.finalTotal);

        const ul = document.getElementById("discountsBreakdown");
        ul.innerHTML = "";
        r.itemBreakdown.forEach((d) => {
            const li = document.createElement("li");
            li.textContent = `${d.name} â€” ${d.detail}: âˆ’${fmtARS(d.amount)}`;
            ul.appendChild(li);
        });
        if (r.thresholdDiscount > 0) {
            const li = document.createElement("li");
            li.textContent = `10% por compras superiores a ${fmtARS(THRESHOLD_DISCOUNT)}: âˆ’${fmtARS(r.thresholdDiscount)}`;
            ul.appendChild(li);
        }
    }
</script>



<script>
    const frag = document.createDocumentFragment();
    const root = document.querySelector('#productContainerRender')
    products.forEach((p) => {
        const col = document.createElement('div');
        col.className = 'col-sm-12 product-card';
        const badge = document.createElement('span');
        badge.className = 'badge text-bg-secondary badge_product';
        if (p.promotion) {
            if ( p.promotion === "2x50OFF"){
                badge.textContent = "2da 50%"
            } else if ( p.promotion === "3x2OFF" ){
                badge.textContent = '3x2';
            }
        }

        const inner = document.createElement('div');
        inner.className = 'text-center';

        const img = document.createElement('img');
        img.className = 'd-block w-100 product-image';
        img.src = p.imageUrl || 'td.png';
        img.alt = p.name || 'Producto';

        const h5 = document.createElement('h5');
        h5.textContent = p.name || 'Producto sin nombre';

        const h6 = document.createElement('h6');
        h6.textContent = '$' + p.priceFormat
        
        const qtyWrap = document.createElement("div");
        qtyWrap.className = "d-flex align-items-center justify-content-center gap-2 my-2";
        const qtyLabel = document.createElement("label");
        qtyLabel.textContent = "Cantidad:";
        qtyLabel.setAttribute("for", `qty-${p.id}`);
        const qtyInput = document.createElement("input");
        qtyInput.type = "number";
        qtyInput.min = "0";
        qtyInput.value = "0";
        qtyInput.id = `qty-${p.id}`;
        qtyInput.className = "form-control";
        qtyInput.style.maxWidth = "100px";
        qtyWrap.appendChild(qtyLabel);
        qtyWrap.appendChild(qtyInput);

        inner.appendChild(img);
        inner.appendChild(h5);
        inner.appendChild(h6);
        inner.appendChild(qtyWrap);
        // inner.appendChild(btn);

        col.appendChild(badge);
        col.appendChild(inner);
        frag.appendChild(col);
    });

  root.appendChild(frag);
  hookInteractions();
  refreshTotals();
</script>
</body>
</html>